<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        
.container {
    max-width: 1000px; 
    margin: auto; 
    background-color: rgb(248, 241, 241);
}
h3 {
    max-width: 200px; 
    margin: auto;
}
select {
    height: 22px;
}
.form {
    max-width: 250px;
    margin: auto;
    display: flex;
    justify-content: space-around;
    flex-direction: column;
    height: 120px;
    border: solid 1px;
    border-radius: 5px;
    padding: 0 20px;
}
main {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    padding: 0 20px;
}

.grid {
    display: grid;
    gap: 10px;
    grid-template-rows: 50px 50px 50px 34px 50px;
    grid-template-columns: 150px 100px;

}
.gridItem {
    grid-row-start: 1;
    grid-row-end: 5;
    max-width: 150px;
}
footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
}
    </style>
</head>
<body>
    <div class="container">
 
        <h3>Search</h3>
        <div class="form">
            <input id="addT" type="text">
            <select name="" id="sel">
                <option id="0" value="">movie</option>
                <option id="1" value="">series</option>
                <option  id="2" value="">episode</option>
            </select>
            <button id="butSel">Search</button>
        </div>
    
        <h3 style="margin: 30px;">Films:</h3>
        <main></main>
        <hr>
        <footer></footer>
<script>
    let select = document.querySelector('#sel');
let inputAdd = document.querySelector('#addT');
let buttonSelect = document.querySelector('#butSel');
let selectTypeVideo;
buttonSelect.addEventListener('click', function () {
    if (select.options.selectedIndex == 0) {
        selectTypeVideo = 'movie';
    } else if (select.options.selectedIndex == 1) {
        selectTypeVideo = 'series';
    } else if (select.options.selectedIndex == 2) {
        selectTypeVideo = 'episod';
    };
    let mainRemove = document.querySelector('main');
    mainRemove.innerHTML = '';

    // 'http://www.omdbapi.com/?apikey=14ec9722&s=war&t=movie&4'
    // Чтоб выводил 10 результатов -'s' вместо 't'

    let url = `http://www.omdbapi.com/?apikey=14ec9722&s=${inputAdd.value}&t=${selectTypeVideo}&4`;
    let data = fetch(url)
        .then((response) => {
            return response.json();
        })
        .then((data) => {
            if (data.Search) {
                data['Search'].forEach(el => {

                    let divV = document.createElement('div');
                    divV.classList.add('grid');
                    let imgV = document.createElement('img');
                    imgV.src = el.Poster;
                    imgV.classList.add('gridItem')
                    let typeV = document.createElement('h5');
                    typeV.textContent = el.Type

                    let titleV = document.createElement('h4');
                    titleV.textContent = el.Title;

                    let yearV = document.createElement('h5');
                    yearV.textContent = el.Year
                    let buttonV = document.createElement('button');
                    buttonV.textContent = 'Details';
                    // buttonV.setAttribute('id', el.imdbID)
                    divV.append(imgV, typeV, titleV, yearV, buttonV)
                    let main = document.querySelector('main').append(divV);

                    buttonV.addEventListener('click', function () {
                        let footerRemove = document.querySelector('footer');

                        footerRemove.innerHTML = '';
                        creatEllInfo(el.imdbID)
                    })
                });
            } else {
                let divNotFound = document.createElement('h2');
                divNotFound.textContent = 'Sorry, video not found :( ';
                document.querySelector('main').append(divNotFound);
            }
        })
        .catch(err => {
            let errMessage = document.createElement('h1');
            errMessage.textContent = 'Error: server not found! '
            let main = document.querySelector('main');
            main.append(errMessage);

        })
        .finally(() => {
            console.log('finally');
        })
});

function creatEllInfo(items) {

    let url = `http://www.omdbapi.com/?apikey=14ec9722&i=${items}`;
    let data = fetch(url)
        .then((response) => {
            return response.json();
        })
        .then((data) => {
            {
                if (data) {
                    let footer = document.querySelector('footer');
                    let imgDetails = document.createElement('img');
                    imgDetails.src = data.Poster;
                    let divDetails = document.createElement('div');
                    let titleDetails = document.createElement('h3');
                    titleDetails.textContent = data.Title;

                    let relised = document.createElement('h4');
                    relised.textContent = data.Released;

                    let genre = document.createElement('h4');
                    genre.textContent = data.Genre;

                    let country = document.createElement('h4');
                    country.textContent = data.Country;

                    let director = document.createElement('h4');
                    director.textContent = data.Director;

                    let writer = document.createElement('h4');
                    writer.textContent = data.Writer;

                    let actors = document.createElement('h5');
                    actors.textContent = data.Actors;

                    let awards = document.createElement('h4');
                    awards.textContent = data.Awards;

                    divDetails.style.width = '600px';
                    divDetails.append(titleDetails, relised, genre, country, director, writer, actors, awards)
                    footer.append(imgDetails, divDetails);
                }
            }
        })
}
let mainTag = document.querySelector('main');
</script>
    </div>
</body>
</html>